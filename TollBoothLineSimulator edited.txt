import java.io.*;
import java.util.*;
public class TollBoothLineSimulator {
	 public static ArrayList<Vehicle> fileVehicles= new ArrayList<Vehicle>();
	 public static int arrivalTime;
	 public static String vehicleType;
	 public static int delayTime; 
	 public static int timer;
	 public static TollBoothLine ManualLines;
	 public static TollBoothLine AutomaticLines;
	 // we should call it delayTime instead of number of wheels because we don't have the number of wheel of manual

	public static void main(String[] args) throws IOException {
		// TODO Auto-generated method stub
		Scanner sc = new Scanner(System.in);
		System.out.print("Input File: ");
		File inputFile =  new File(sc.nextLine());
		Scanner scan = new Scanner(inputFile);
		Scanner scan1 = new Scanner(inputFile);
		System.out.print("Manual Toll Booths: ");
		int manualTB = sc.nextInt();
		System.out.print("Automatic Toll Booths: ");
		int automaticTB = sc.nextInt();
		
		 ManualLines = new TollBoothLine(manualTB);
		 AutomaticLines = new TollBoothLine(automaticTB);
		
		while (scan.hasNextLine())
		{
			
			 String vehicleInFile= scan.nextLine();
			 StringTokenizer stringTokenizer = new StringTokenizer(vehicleInFile, ",");
			 arrivalTime= Integer.parseInt(stringTokenizer.nextElement().toString());
			 vehicleType = stringTokenizer.nextElement().toString();
			 if  (vehicleType.equals("M"))
			 {
				 delayTime = Integer.parseInt(stringTokenizer.nextElement().toString());
			 }
			 else delayTime = 1;
			 Vehicle v= new Vehicle (arrivalTime, vehicleType, delayTime);
			 fileVehicles.add(v);
			
		}
		
		int timer= 1;
		int numberOfVehiclesInLines=0;
		boolean time = false;

				
		for (int i=0; i<fileVehicles.size(); i++)
		{
				Vehicle vehicle = fileVehicles.get(i);
				if (vehicle.getArrivalTime()==timer)
					{
						if (vehicle.getVehicleType().equals("M"))
						{
							System.out.println(vehicle);
							ManualLines.insert(vehicle);
							numberOfVehiclesInLines= numberOfVehiclesInLines+1 ;
						}
						else if (vehicle.getVehicleType().equals("A"))
						{
							System.out.println(vehicle);
							AutomaticLines.insert(vehicle);
							numberOfVehiclesInLines= numberOfVehiclesInLines+1 ;
						}
					}
			
				else if (vehicle.getArrivalTime()>timer)
				{
					while(timer!= vehicle.getArrivalTime())
					{
						int lastTimer= timer;
						for (int j=0; j<numberOfVehiclesInLines; j++)
						{
							Vehicle v2= fileVehicles.get(j);
							int deleteTime= lastTimer+ v2.delayTime();
							if ((timer+1)== deleteTime && v2.getVehicleType().equals("M")) 
							{
								ManualLines.moveUp(ManualLines.isThere(v2));
							}
							else if (timer== deleteTime && v2.getVehicleType().equals("A")) 
							{
								AutomaticLines.moveUp(AutomaticLines.isThere(v2));
							}
						}
						timer++;
					}
				
			}
			
		}
		for (int k=0; k<manualTB; k++ )
		{
			System.out.println("Manual Line " + k + " Maximum Length= " + ManualLines.getMaxLenght(k));
			
		}
		for (int k=0; k<automaticTB; k++ )
		{
			System.out.println("Automatic Line " + k + " Maximum Length= " + AutomaticLines.getMaxLenght(k));
			
		}

		
		

	}

}
